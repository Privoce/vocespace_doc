import { Tab, Tabs } from "@theme";

# å¸®åŠ©

## æŸ¥çœ‹è‡ªå·±çš„linuxæ¶æ„

VoceSpaceå«æœ‰ä¸¤ç§é•œåƒ:
- amd: `privoce/vocespace:latest`
- arm: `privoce/vocespace:latest_arm`

æ‰€ä»¥æ‚¨éœ€è¦çŸ¥é“è‡ªå·±å½“å‰çš„æœåŠ¡å™¨æ¶æ„è¿›è¡Œé€‰æ‹©

### 1. ä½¿ç”¨ `uname` å‘½ä»¤

`uname` å‘½ä»¤å¯ä»¥æ˜¾ç¤ºç³»ç»Ÿçš„å†…æ ¸ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¡¬ä»¶æ¶æ„ã€‚

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```bash
uname -m
```

- å¦‚æœè¾“å‡ºä¸º `x86_64`ï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿæ˜¯åŸºäº AMD64 æˆ– Intel64 æ¶æ„ï¼ˆé€šå¸¸ç§°ä¸º x86_64ï¼‰ã€‚
- å¦‚æœè¾“å‡ºä¸º `aarch64` æˆ– `arm64`ï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿæ˜¯åŸºäº ARM64 æ¶æ„ã€‚
- å¦‚æœè¾“å‡ºä¸º `armv7l` æˆ–ç±»ä¼¼å†…å®¹ï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿæ˜¯åŸºäº ARMv7 æ¶æ„ã€‚

### 2. ä½¿ç”¨ `arch` å‘½ä»¤
`arch` å‘½ä»¤ä¹Ÿå¯ä»¥æ˜¾ç¤ºç³»ç»Ÿçš„æ¶æ„ç±»å‹ã€‚

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```bash
arch
```

- å¦‚æœè¾“å‡ºä¸º `x86_64`ï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿæ˜¯åŸºäº AMD64 æˆ– Intel64 æ¶æ„ã€‚
- å¦‚æœè¾“å‡ºä¸º `aarch64` æˆ– `arm64`ï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿæ˜¯åŸºäº ARM64 æ¶æ„ã€‚
- å¦‚æœè¾“å‡ºä¸º `armv7l` æˆ–ç±»ä¼¼å†…å®¹ï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿæ˜¯åŸºäº ARMv7 æ¶æ„ã€‚

## å¦‚ä½•è·å–keyå’Œsecret

```bash
docker pull livekit/generate
docker run --rm -it -v $PWD:/output livekit/generate
```

é€šè¿‡`livekit/generate`ä½ ä¼šå¾—åˆ°ä¸€ä¸ª`livekit.yaml`æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯ä½ çš„livekit-serverçš„é…ç½®æ–‡ä»¶ï¼Œkeyå’Œsecretå°±ä¼šç”Ÿæˆåœ¨å…¶ä¸­

## å¦‚ä½•æé«˜è§†é¢‘/å±å¹•åˆ†äº«çš„è´¨é‡

| åˆ†è¾¨ç‡              | åƒç´       | å¸§ç‡  | ç¼–ç å™¨ | æ¨èç ç‡ | é«˜è´¨é‡ç ç‡ | æè‡´ç ç‡ |
| ------------------- | --------- | ----- | ------ | -------- | ---------- | -------- |
| **540p (qHD)**      | 960Ã—540   | 30fps | H.264  | 800 Kbps | 1 Mbps     | 1.5 Mbps |
|                     |           |       | VP9    | 600 Kbps | 800 Kbps   | 1.2 Mbps |
|                     |           |       | AV1    | 400 Kbps | 700 Kbps   | 1 Mbps   |
| **720p (HD)**       | 1280Ã—720  | 30fps | H.264  | 1.5 Mbps | 2 Mbps     | 2.5 Mbps |
|                     |           | 60fps | H.264  | 2.5 Mbps | 3.5 Mbps   | 4 Mbps   |
|                     |           |       | VP9    | 1.2 Mbps | 1.8 Mbps   | 2.2 Mbps |
|                     |           |       | AV1    | 1 Mbps   | 1.5 Mbps   | 2 Mbps   |
| **1080p (Full HD)** | 1920Ã—1080 | 30fps | H.264  | 3 Mbps   | 4.5 Mbps   | 6 Mbps   |
|                     |           | 60fps | H.264  | 4.5 Mbps | 6 Mbps     | 8 Mbps   |
|                     |           |       | VP9    | 2.5 Mbps | 4 Mbps     | 5 Mbps   |
|                     |           |       | AV1    | 1.8 Mbps | 3 Mbps     | 4 Mbps   |
| **1440p (2K/QHD)**  | 2560Ã—1440 | 30fps | H.264  | 6 Mbps   | 8 Mbps     | 10 Mbps  |
|                     |           | 60fps | H.264  | 8 Mbps   | 10 Mbps    | 14 Mbps  |
|                     |           |       | VP9    | 4.5 Mbps | 7 Mbps     | 9 Mbps   |
|                     |           |       | AV1    | 3.5 Mbps | 5 Mbps     | 7 Mbps   |
| **2160p (4K/UHD)**  | 3840Ã—2160 | 30fps | H.264  | 10 Mbps  | 14 Mbps    | 20 Mbps  |
|                     |           | 60fps | H.264  | 15 Mbps  | 20 Mbps    | 25 Mbps  |
|                     |           |       | VP9    | 8 Mbps   | 12 Mbps    | 18 Mbps  |
|                     |           |       | AV1    | 6 Mbps   | 10 Mbps    | 14 Mbps  |

### è¯´æ˜

* **æ¨èç ç‡**ï¼šé€‚åˆæ—¥å¸¸ç›´æ’­ã€ä¼šè®®ã€ä½å»¶è¿Ÿæ¨æµã€‚
* **é«˜è´¨é‡ç ç‡**ï¼šé€‚åˆ YouTube ä¸Šä¼ æˆ–å½•æ’­ï¼Œå…¼é¡¾è´¨é‡ä¸æ–‡ä»¶å¤§å°ã€‚
* **æè‡´ç ç‡**ï¼šç”¨äºé«˜è´¨é‡ä¿ç•™æˆ–ä¸“ä¸šåœºæ™¯ï¼Œå¦‚ç´ æé‡‡é›†ã€è§†é¢‘å‰ªè¾‘æºã€‚
* **ç¼–ç å™¨è¯´æ˜**ï¼š

  * **H.264**ï¼šå…¼å®¹æ€§æœ€å¥½ï¼Œç¡¬ä»¶æ”¯æŒå¹¿æ³›ã€‚
  * **VP9**ï¼šGoogle æ¨å‡ºï¼ŒYouTube å¹¿æ³›é‡‡ç”¨ï¼Œæ•ˆç‡ç•¥é«˜äº H.264ã€‚
  * **AV1**ï¼šä¸‹ä¸€ä»£é«˜å‹ç¼©æ¯”ç¼–ç æ ¼å¼ï¼Œæ–‡ä»¶æ›´å°ï¼Œä½†ç¼–ç è€—æ—¶è¾ƒé•¿ã€‚


### å¯¹åº”å¯åŠ¨å‚æ•°

- åˆ†è¾¨ç‡: `NEXT_PUBLIC_RESOLUTION`
- ç ç‡: `NEXT_PUBLIC_MAXBITRATE`
- å¸§ç‡: `NEXT_PUBLIC_MAXFRAMERATE`
- ç­–ç•¥: `NEXT_PUBLIC_PRIORITY`
  - high
  - medium
  - low
  - very-low

### ä¾‹å­

å½“æ‚¨éœ€è¦ä½¿ç”¨720p + 60å¸§ + é«˜ç²¾åº¦ç­–ç•¥æ—¶

```bash 
bash ./local_deploy.sh \
-e NEXT_PUBLIC_RESOLUTION=720p \
-e NEXT_PUBLIC_MAXFRAMERATE=60 \
-e NEXT_PUBLIC_PRIORITY=high
```

## æœ¬åœ°éƒ¨ç½²è„šæœ¬

<Tabs>
  <Tab label="Linux/macOS">
    ```shell
    #!/bin/bash

    # VoceSpace æœ¬åœ°éƒ¨ç½²è‡ªåŠ¨åŒ–è„šæœ¬
    # é€‚ç”¨äº macOS å’Œ Linux ç³»ç»Ÿ

    set -e # é‡åˆ°é”™è¯¯æ—¶é€€å‡º

    # é»˜è®¤ç¯å¢ƒå˜é‡
    CUSTOM_ENV_VARS=()

    # æ˜¾ç¤ºä½¿ç”¨å¸®åŠ©
    show_help() {
    echo "================================================"
    echo "VoceSpace æœ¬åœ°éƒ¨ç½²è‡ªåŠ¨åŒ–è„šæœ¬"
    echo "================================================"
    echo ""
    echo "ç”¨æ³•ï¼š$0 [é€‰é¡¹]"
    echo ""
    echo "é€‰é¡¹ï¼š"
    echo " -e, --env KEY=VALUE è®¾ç½®è‡ªå®šä¹‰ç¯å¢ƒå˜é‡"
    echo " -h, --help æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"
    echo ""
    echo "ç¤ºä¾‹ï¼š"
    echo " $0 -e NEXT_PUBLIC_RESOLUTION=4k
    echo " $0 -e NEXT_PUBLIC_RESOLUTION=1080p"
    echo " $0 -e NEXT_PUBLIC_RESOLUTION=4k -e CUSTOM_VAR=value"
    echo " $0 -e NEXT_PUBLIC_MAXBITRATE=8000 -e NEXT_PUBLIC_RESOLUTION=720p"
    echo ""
    echo "å¸¸ç”¨ç¯å¢ƒå˜é‡ï¼š
    echo " - NEXT_PUBLIC_RESOLUTIONï¼šè®¾ç½®åˆ†è¾¨ç‡ï¼ˆ4kã€2kã€1080pã€720pã€480pï¼‰"
    echo " - NEXT_PUBLIC_MAXBITRATEï¼šè®¾ç½®æœ€å¤§æ¯”ç‰¹ç‡"
    echo " - NEXT_PUBLIC_MAXFRAMERATEï¼šè®¾ç½®æœ€å¤§å¸§ç‡"
    echo " - NEXT_PUBLIC_PRIORITYï¼šè®¾ç½®ä¼˜å…ˆçº§"
    echo ""
    }

    # è§£æå‘½ä»¤è¡Œå‚æ•°
    parse_args() {
        while [[ $# -gt 0 ]]; do
            case $1 in
                -e|--env)
                    CUSTOM_ENV_VARS+=("$2")
                    shift 2
                    ;;
                -h|--help)
                    show_help
                    exit 0
                    ;;
                *)
                    echo "âŒ æœªçŸ¥å‚æ•°: $1"
                    echo "ä½¿ç”¨ $0 --help æŸ¥çœ‹ä½¿ç”¨ä¿¡æ¯"
                    exit 1
                    ;;
            esac
        done
    }

    echo "=========================================="
    echo "VoceSpace æœ¬åœ°éƒ¨ç½²è‡ªåŠ¨åŒ–è„šæœ¬"
    echo "=========================================="

    # æ£€æµ‹æ“ä½œç³»ç»Ÿ
    OS=$(uname -s)
    ARCH=$(uname -m)

    echo "æ“ä½œç³»ç»Ÿ: $OS"
    echo "æ¶æ„: $ARCH"

    # Function: Check if a command exists
    check_command() {
        if ! command -v "$1" &> /dev/null; then
            echo "âŒ $1 æœªå®‰è£…"
            return 1
        else
            echo "âœ… $1 å·²å®‰è£…"
            return 0
        fi
    }

    #åŠŸèƒ½ï¼šæ£€æŸ¥Dockeræ˜¯å¦å®‰è£…
    check_docker() {
        if check_command docker; then
            echo "Dockerç‰ˆæœ¬: $(docker --version)"
            return 0
        else
            echo "âŒ Dockeræœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…Docker"
            echo "è¯·è®¿é—®ä»¥ä¸‹é“¾æ¥å®‰è£…Docker:"
            case $OS in
                "Darwin")
                    echo "  macOS: https://docs.docker.com/desktop/install/mac-install/"
                    ;;
                "Linux")
                    echo "  Linux: https://docs.docker.com/engine/install/"
                    ;;
                *)
                    echo "  other: https://docs.docker.com/get-docker/"
                    ;;
            esac
            return 1
        fi
    }

    # å®‰è£… LiveKit Server
    install_livekit() {
        echo "=========================================="
        echo "å®‰è£… LiveKit Server"
        echo "=========================================="
        
        if check_command livekit-server; then
            echo "LiveKit Server å·²å®‰è£…"
            return 0
        fi
        
        case $OS in
            "Darwin")
                echo "åœ¨ macOS ä¸Šå®‰è£… LiveKit Server..."
                if check_command brew; then
                    brew update && brew install livekit
                else
                    echo "âŒ Homebrew æœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£… Homebrew æˆ–æ‰‹åŠ¨å®‰è£… LiveKit Server"
                    echo "Homebrew å®‰è£…å‘½ä»¤: /bin/bash -c \"\$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\""
                    return 1
                fi
                ;;
            "Linux")
                echo "åœ¨ Linux ä¸Šå®‰è£… LiveKit Server..."
                curl -sSL https://get.livekit.io | bash
                ;;
            *)
                echo "âŒ ä¸æ”¯æŒçš„æ“ä½œç³»ç»Ÿ: $OS"
                echo "è¯·æ‰‹åŠ¨å®‰è£… LiveKit Server: https://github.com/livekit/livekit/releases"
                return 1
                ;;
        esac
    }

    # Function: è·å– Docker é•œåƒ
    get_docker_image() {
        case $ARCH in
            "x86_64"|"amd64")
                echo "privoce/vocespace:latest"
                ;;
            "arm64"|"aarch64")
                echo "privoce/vocespace:latest_arm"
                ;;
            *)
                echo "âŒ ä¸æ”¯æŒçš„æ¶æ„: $ARCH"
                echo "æ”¯æŒçš„æ¶æ„: x86_64, amd64, arm64, aarch64"
                exit 1
                ;;
        esac
    }

    # Function: æ‹‰å– VoceSpace image
    pull_vocespace_image() {
        echo "=========================================="
        echo "æ‹‰å– VoceSpace Docker image"
        echo "=========================================="
        
        IMAGE=$(get_docker_image)
        echo "æ‹‰å–é•œåƒ: $IMAGE"

        docker pull "$IMAGE"
        echo "âœ… é•œåƒæ‹‰å–æˆåŠŸ"
    }

    # Function: å¯åŠ¨ VoceSpace å®¹å™¨
    start_vocespace_container() {
        echo "=========================================="
        echo "å¯åŠ¨ VoceSpace å®¹å™¨"
        echo "=========================================="
        
        IMAGE=$(get_docker_image)
        CONTAINER_NAME="vocespace"

        # Build environment variable arguments
        ENV_ARGS=()

        # Add custom environment variables
        for env_var in "${CUSTOM_ENV_VARS[@]}"; do
            ENV_ARGS+=("-e" "$env_var")
            echo "è®¾ç½®ç¯å¢ƒå˜é‡: $env_var"
        done

        # Check if the container already exists
        if docker ps -a --format "table {{.Names}}" | grep -q "^$CONTAINER_NAME$"; then
            echo "æ£€æµ‹åˆ°ç°æœ‰å®¹å™¨ $CONTAINER_NAME"
            read -p "æ˜¯å¦è¦åœæ­¢å¹¶åˆ é™¤ç°æœ‰å®¹å™¨? (y/n): " -n 1 -r
            echo
            if [[ $REPLY =~ ^[Yy]$ ]]; then
                echo "åœæ­¢å¹¶åˆ é™¤ç°æœ‰å®¹å™¨..."
                docker stop "$CONTAINER_NAME" 2>/dev/null || true
                docker rm "$CONTAINER_NAME" 2>/dev/null || true
            else
                echo "æ“ä½œå·²å–æ¶ˆ"
                return 1
            fi
        fi

        echo "å¯åŠ¨æ–°å®¹å™¨..."
        if [[ ${#ENV_ARGS[@]} -gt 0 ]]; then
            echo "ä½¿ç”¨ç¯å¢ƒå˜é‡: ${ENV_ARGS[*]}"
            docker run -d \
                -p 3000:3000 \
                --name "$CONTAINER_NAME" \
                "${ENV_ARGS[@]}" \
                "$IMAGE"
        else
            docker run -d \
                -p 3000:3000 \
                --name "$CONTAINER_NAME" \
                "$IMAGE"
        fi

        echo "âœ… VoceSpace å®¹å™¨å·²å¯åŠ¨"
        echo "å®¹å™¨åç§°: $CONTAINER_NAME"
        echo "è®¿é—® URL: http://localhost:3000"
    }

    # Function: å¯åŠ¨ LiveKit Server
    start_livekit_server() {
        echo "=========================================="
        echo "å¯åŠ¨ LiveKit Server"
        echo "=========================================="

        echo "æ£€æŸ¥ LiveKit Server æ˜¯å¦æ­£åœ¨è¿è¡Œ..."
        if pgrep -f "livekit-server" > /dev/null; then
            echo "âš ï¸  LiveKit Server å·²åœ¨è¿è¡Œ"
            read -p "æ˜¯å¦è¦é‡å¯ LiveKit Server? (y/n): " -n 1 -r
            echo
            if [[ $REPLY =~ ^[Yy]$ ]]; then
                echo "åœæ­¢ç°æœ‰çš„ LiveKit Server..."
                pkill -f "livekit-server" || true
                sleep 2
            else
                echo "ä¿æŒç°æœ‰çš„ LiveKit Server è¿è¡Œ"
                return 0
            fi
        fi

        echo "å¯åŠ¨ LiveKit Server..."
        echo "æ³¨æ„: LiveKit Server å°†åœ¨åå°è¿è¡Œ"
        echo "è¦åœæ­¢å®ƒï¼Œè¯·ä½¿ç”¨: pkill -f livekit-server"

        nohup livekit-server --dev --bind 0.0.0.0 > livekit-server.log 2>&1 &
        
        sleep 3
        
        if pgrep -f "livekit-server" > /dev/null; then
            echo "âœ… LiveKit Server å¯åŠ¨æˆåŠŸ"
            echo "æ—¥å¿—æ–‡ä»¶: $(pwd)/livekit-server.log"
        else
            echo "âŒ LiveKit Server å¯åŠ¨å¤±è´¥"
            echo "è¯·æ£€æŸ¥æ—¥å¿—æ–‡ä»¶: $(pwd)/livekit-server.log"
            return 1
        fi
    }

    # Function: Show Status
    show_status() {
        echo "=========================================="
        echo "å½“å‰çŠ¶æ€"
        echo "=========================================="
        
        echo "Docker å®¹å™¨çŠ¶æ€:"
        docker ps --filter "name=vocespace" --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
        
        echo ""
        echo "LiveKit Server çŠ¶æ€:"
        if pgrep -f "livekit-server" > /dev/null; then
            echo "âœ… LiveKit Server å·²åœ¨è¿è¡Œ"
        else
            echo "âŒ LiveKit Server æœªåœ¨è¿è¡Œ"
        fi
        
        echo ""
        echo "=========================================="
        echo "è®¿é—®ä¿¡æ¯"
        echo "=========================================="
        echo "VoceSpace App: http://localhost:3000"
        echo "LiveKit Server: ws://localhost:7880"
        echo ""
        echo "è¦æŸ¥çœ‹å®¹å™¨æ—¥å¿—: docker logs vocespace"
        echo "è¦æŸ¥çœ‹ LiveKit æ—¥å¿—: tail -f livekit-server.log"
    }

    # Main function
    main() {
        # Parse command line arguments
        parse_args "$@"

        echo "å¯åŠ¨éƒ¨ç½²è¿‡ç¨‹..."

        # Show configuration information
        if [[ ${#CUSTOM_ENV_VARS[@]} -gt 0 ]]; then
            echo "=========================================="
            echo "é…ç½®æ–‡ä»¶ä¿¡æ¯"
            echo "=========================================="
            for env_var in "${CUSTOM_ENV_VARS[@]}"; do
                echo "ç¯å¢ƒå˜é‡: $env_var"
            done
            echo ""
        fi

        # Check Docker
        if ! check_docker; then
            exit 1
        fi

        # Install LiveKit Server
        if ! install_livekit; then
            echo "âŒ LiveKit Server å®‰è£…å¤±è´¥"
            exit 1
        fi

        # Pull Docker image
        if ! pull_vocespace_image; then
            echo "âŒ Docker é•œåƒæ‹‰å–å¤±è´¥"
            exit 1
        fi

        # Start container
        if ! start_vocespace_container; then
            echo "âŒ å®¹å™¨å¯åŠ¨å¤±è´¥"
            exit 1
        fi

        # Start LiveKit Server
        if ! start_livekit_server; then
            echo "âŒ LiveKit Server å¯åŠ¨å¤±è´¥"
            exit 1
        fi
        
        echo ""
        echo "ç­‰å¾…æœåŠ¡å¯åŠ¨..."
        sleep 5

        # Show status
        show_status
        
        echo ""
        echo "==========================================="
        echo "ğŸ‰ éƒ¨ç½²å®Œæˆï¼"
        echo "==========================================="
        echo "è¯·åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3000"
        echo "å¦‚æœæ‚¨é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ç›¸å…³æ—¥å¿—æ–‡ä»¶"
    }

    # Run main function
    main "$@"

    ```
  </Tab>
  <Tab label="Windows">
    ```shell
    @echo off
    setlocal EnableDelayedExpansion

    REM VoceSpace æœ¬åœ°éƒ¨ç½²è‡ªåŠ¨åŒ–è„šæœ¬ (Windows)
    REM é€‚ç”¨äº Windows ç³»ç»Ÿ

    REM é»˜è®¤ç¯å¢ƒå˜é‡
    set ENV_VARS=

    REM æ˜¾ç¤ºä½¿ç”¨å¸®åŠ©
    :show_help
    echo ==========================================
    echo VoceSpace æœ¬åœ°éƒ¨ç½²è‡ªåŠ¨åŒ–è„šæœ¬ (Windows)
    echo ==========================================
    echo.
    echo ç”¨æ³•: %~nx0 [é€‰é¡¹]
    echo.
    echo é€‰é¡¹:
    echo   -e, --env KEY=VALUE            è®¾ç½®è‡ªå®šä¹‰ç¯å¢ƒå˜é‡
    echo   -h, --help                     æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯
    echo.
    echo ç¤ºä¾‹:
    echo   %~nx0 -e NEXT_PUBLIC_RESOLUTION=4k
    echo   %~nx0 -e NEXT_PUBLIC_RESOLUTION=1080p
    echo   %~nx0 -e NEXT_PUBLIC_RESOLUTION=4k -e CUSTOM_VAR=value
    echo   %~nx0 -e NEXT_PUBLIC_MAXBITRATE=8000 -e NEXT_PUBLIC_RESOLUTION=720p
    echo.
    echo å¸¸ç”¨ç¯å¢ƒå˜é‡:
    echo   - NEXT_PUBLIC_RESOLUTION: è®¾ç½®åˆ†è¾¨ç‡ (4k, 2k, 1080p, 720p, 480p)
    echo   - NEXT_PUBLIC_MAXBITRATE: è®¾ç½®æœ€å¤§æ¯”ç‰¹ç‡
    echo   - NEXT_PUBLIC_MAXFRAMERATE: è®¾ç½®æœ€å¤§å¸§ç‡
    echo   - NEXT_PUBLIC_PRIORITY: è®¾ç½®ä¼˜å…ˆçº§
    echo.
    goto :eof

    REM è§£æå‘½ä»¤è¡Œå‚æ•°
    :parse_args
    if "%~1"=="" goto start_main
    if "%~1"=="-h" goto show_help
    if "%~1"=="--help" goto show_help
    if "%~1"=="-e" (
        if "!ENV_VARS!"=="" (
            set ENV_VARS=-e %~2
        ) else (
            set ENV_VARS=!ENV_VARS! -e %~2
        )
        shift
        shift
        goto parse_args
    )
    if "%~1"=="--env" (
        if "!ENV_VARS!"=="" (
            set ENV_VARS=-e %~2
        ) else (
            set ENV_VARS=!ENV_VARS! -e %~2
        )
        shift
        shift
        goto parse_args
    )
    echo âŒ æœªçŸ¥å‚æ•°: %~1
    echo ä½¿ç”¨ %~nx0 --help æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
    exit /b 1

    :start_main
    REM è°ƒç”¨å‚æ•°è§£æ
    call :parse_args %*

    echo ==========================================
    echo VoceSpace æœ¬åœ°éƒ¨ç½²è‡ªåŠ¨åŒ–è„šæœ¬ (Windows)
    echo ==========================================

    REM æ˜¾ç¤ºå°†è¦ä½¿ç”¨çš„ç¯å¢ƒå˜é‡
    if not "!ENV_VARS!"=="" (
        echo å°†ä½¿ç”¨ä»¥ä¸‹ç¯å¢ƒå˜é‡: !ENV_VARS!
    )

    REM æ£€æµ‹ç³»ç»Ÿæ¶æ„
    set ARCH=%PROCESSOR_ARCHITECTURE%
    echo æ£€æµ‹åˆ°æ¶æ„: %ARCH%

    REM æ£€æŸ¥ Docker æ˜¯å¦å®‰è£…
    echo æ£€æŸ¥ Docker å®‰è£…çŠ¶æ€...
    docker --version >nul 2>&1
    if %errorlevel% neq 0 (
        echo âŒ Docker æœªå®‰è£…
        echo è¯·å…ˆå®‰è£… Docker Desktop for Windows:
        echo https://docs.docker.com/desktop/install/windows-install/
        pause
        exit /b 1
    ) else (
        echo âœ… Docker å·²å®‰è£…
        docker --version
    )

    REM ç¡®å®š Docker é•œåƒ
    if "%ARCH%"=="AMD64" (
        set IMAGE=privoce/vocespace:latest
        echo ä½¿ç”¨ AMD64 é•œåƒ: %IMAGE%
    ) else if "%ARCH%"=="ARM64" (
        set IMAGE=privoce/vocespace:latest_arm
        echo ä½¿ç”¨ ARM64 é•œåƒ: %IMAGE%
    ) else (
        echo âŒ ä¸æ”¯æŒçš„æ¶æ„: %ARCH%
        echo æ”¯æŒçš„æ¶æ„: AMD64, ARM64
        pause
        exit /b 1
    )

    REM æ‹‰å– VoceSpace é•œåƒ
    echo ==========================================
    echo æ‹‰å– VoceSpace Docker é•œåƒ
    echo ==========================================
    echo æ‹‰å–é•œåƒ: %IMAGE%

    docker pull %IMAGE%
    if %errorlevel% neq 0 (
        echo âŒ é•œåƒæ‹‰å–å¤±è´¥
        pause
        exit /b 1
    )
    echo âœ… é•œåƒæ‹‰å–å®Œæˆ

    REM å¯åŠ¨ VoceSpace å®¹å™¨
    echo ==========================================
    echo å¯åŠ¨ VoceSpace å®¹å™¨
    echo ==========================================

    set CONTAINER_NAME=vocespace

    REM æ£€æŸ¥å®¹å™¨æ˜¯å¦å·²å­˜åœ¨
    docker ps -a --filter "name=%CONTAINER_NAME%" --format "{{.Names}}" | findstr /x "%CONTAINER_NAME%" >nul 2>&1
    if %errorlevel% equ 0 (
        echo æ£€æµ‹åˆ°å·²å­˜åœ¨çš„å®¹å™¨ %CONTAINER_NAME%
        set /p CHOICE="æ˜¯å¦è¦åœæ­¢å¹¶ç§»é™¤ç°æœ‰å®¹å™¨ï¼Ÿ(y/n): "
        if /i "!CHOICE!"=="y" (
            echo åœæ­¢å¹¶ç§»é™¤ç°æœ‰å®¹å™¨...
            docker stop %CONTAINER_NAME% >nul 2>&1
            docker rm %CONTAINER_NAME% >nul 2>&1
        ) else (
            echo å–æ¶ˆæ“ä½œ
            pause
            exit /b 1
        )
    )

    echo å¯åŠ¨æ–°å®¹å™¨...
    if "!ENV_VARS!"=="" (
        docker run -d -p 3000:3000 --name %CONTAINER_NAME% %IMAGE%
    ) else (
        docker run -d -p 3000:3000 !ENV_VARS! --name %CONTAINER_NAME% %IMAGE%
    )
    if %errorlevel% neq 0 (
        echo âŒ å®¹å™¨å¯åŠ¨å¤±è´¥
        pause
        exit /b 1
    )

    echo âœ… VoceSpace å®¹å™¨å¯åŠ¨å®Œæˆ
    echo å®¹å™¨åç§°: %CONTAINER_NAME%
    echo è®¿é—®åœ°å€: http://localhost:3000

    REM LiveKit Server è¯´æ˜
    echo ==========================================
    echo LiveKit Server å®‰è£…è¯´æ˜
    echo ==========================================
    echo å¯¹äº Windows ç³»ç»Ÿï¼Œè¯·æ‰‹åŠ¨ä¸‹è½½å¹¶å®‰è£… LiveKit Server:
    echo 1. è®¿é—®: https://github.com/livekit/livekit/releases
    echo 2. ä¸‹è½½é€‚åˆæ‚¨ç³»ç»Ÿçš„ç‰ˆæœ¬
    echo 3. è§£å‹åˆ°åˆé€‚çš„ç›®å½•
    echo 4. åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ: livekit-server --dev --bind 0.0.0.0
    echo.

    REM æ£€æŸ¥ LiveKit Server æ˜¯å¦å¯ç”¨
    livekit-server --help >nul 2>&1
    if %errorlevel% equ 0 (
        echo âœ… LiveKit Server å·²å®‰è£…
        echo å¯åŠ¨ LiveKit Server...
        start /b livekit-server --dev --bind 0.0.0.0
        timeout /t 3 /nobreak >nul
        echo âœ… LiveKit Server å·²å¯åŠ¨
    ) else (
        echo âš ï¸  LiveKit Server æœªæ‰¾åˆ°ï¼Œè¯·æŒ‰ç…§ä¸Šè¿°è¯´æ˜æ‰‹åŠ¨å®‰è£…
    )

    REM æ˜¾ç¤ºçŠ¶æ€
    echo ==========================================
    echo éƒ¨ç½²çŠ¶æ€æ£€æŸ¥
    echo ==========================================

    echo Docker å®¹å™¨çŠ¶æ€:
    docker ps --filter "name=%CONTAINER_NAME%" --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"

    echo.
    echo ==========================================
    echo è®¿é—®ä¿¡æ¯
    echo ==========================================
    echo VoceSpace åº”ç”¨: http://localhost:3000
    echo LiveKit Server: ws://localhost:7880
    echo.
    echo å¦‚éœ€æŸ¥çœ‹å®¹å™¨æ—¥å¿—: docker logs %CONTAINER_NAME%
    echo.

    echo ==========================================
    echo ğŸ‰ éƒ¨ç½²å®Œæˆï¼
    echo ==========================================
    echo è¯·åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3000
    echo å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ç›¸å…³æ—¥å¿—

    pause

    ```
  </Tab>
</Tabs>


## Docker ç½‘ç»œè¿æ¥è¶…æ—¶

### ğŸ‘ é€‰æ‹©ä½¿ç”¨ä¸­å›½å›½å†…é•œåƒ

#### AMD64

```bash
docker pull crpi-0u8xaje6k9g42uky.cn-hangzhou.personal.cr.aliyuncs.com/vocespace/vocespace:latest
```

#### ARM64

```bash
docker pull crpi-0u8xaje6k9g42uky.cn-hangzhou.personal.cr.aliyuncs.com/vocespace/vocespace:latest_arm
```

### é…ç½®Docker

å›½å†…ç”¨æˆ·å¯èƒ½ä¼šé‡åˆ°Docker Hubè®¿é—®è¿æ¥è¶…æ—¶çš„é—®é¢˜ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹å†…å®¹è¿›è¡Œé…ç½®ã€‚

#### åˆ›å»ºdaemon.json

```bash
sudo mkdir -p /etc/docker
sudo touch /etc/docker/daemon.json
```

#### æ·»åŠ ä»“åº“é•œåƒ

- è…¾è®¯: `https://mirror.ccs.tencentyun.com`
- ç§‘å¤§: `https://docker.mirrors.ustc.edu.cn`
- é˜¿é‡Œ: è§ æ§åˆ¶å° -> æœç´¢ -> é•œåƒå®¹å™¨æœåŠ¡ACR -> é•œåƒå·¥å…· -> é•œåƒåŠ é€Ÿ

```bash
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://mirror.ccs.tencentyun.com", "https://docker.mirrors.ustc.edu.cn"]
}
EOF
```

#### é‡å¯docker

```bash
sudo systemctl daemon-reload
sudo systemctl restart docker
```

### æ›´æ¢æœåŠ¡å™¨

åœ¨ä¸­å›½å›½å†…ï¼Œå³ä½¿æœåŠ¡å™¨æ‹¥æœ‰å…¬ç½‘ IPï¼Œä¹Ÿå¯èƒ½æ— æ³•æµç•…è®¿é—® Docker Hubã€GitHub ç­‰å¤–ç½‘æœåŠ¡ã€‚è¿™ä¸»è¦æ˜¯ç”±äºç½‘ç»œç¯å¢ƒçš„å¤æ‚æ€§ä»¥åŠç›¸å…³æ”¿ç­–çš„é™åˆ¶ã€‚ä»¥ä¸‹æ˜¯å¯èƒ½çš„åŸå› åŠè§£å†³æ–¹æ³•ï¼š
å¸¸è§åŸå› 

- DNS è§£æé—®é¢˜ï¼šé»˜è®¤çš„ DNS æœåŠ¡å™¨å¯èƒ½æ— æ³•æ­£ç¡®è§£æ Docker Hub æˆ– GitHub çš„åŸŸå
- ç½‘ç»œé™åˆ¶ï¼šæŸäº›ç½‘ç»œç¯å¢ƒï¼ˆå¦‚è¿è¥å•†ç½‘ç»œã€ä¼ä¸šå†…ç½‘ï¼‰å¯èƒ½ä¼šé™åˆ¶æˆ–å±è”½å¯¹ç‰¹å®šå¤–ç½‘æœåŠ¡çš„è®¿é—®
- é˜²ç«å¢™æˆ–å®‰å…¨ç­–ç•¥ï¼šæœåŠ¡å™¨çš„é˜²ç«å¢™æˆ–å®‰å…¨ç»„è§„åˆ™å¯èƒ½é˜»æ­¢äº†å¯¹ç‰¹å®šæœåŠ¡çš„è®¿é—®
- GFW å½±å“ï¼šåœ¨å›½å†…ï¼Œéƒ¨åˆ†å¤–ç½‘æœåŠ¡å¯èƒ½å—åˆ° GFW çš„é™åˆ¶

> [!TIP]
>
> å› æ­¤æˆ‘ä»¬æ¨èæ‚¨è´­ä¹°åœ°åŒº:
> 1. ä¸­å›½é¦™æ¸¯
> 2. æ—¥æœ¬
> 3. éŸ©å›½
> 4. æ–°åŠ å¡
> 5. æ¬§ç¾å›½å®¶

## Docker å¸¸ç”¨æŒ‡ä»¤

### æŸ¥çœ‹é•œåƒ

```bash
docker image ls
# æˆ–ä½¿ç”¨
docker images
```

### æŸ¥çœ‹æ‰€æœ‰å®¹å™¨

```bash
docker ps -a
```

### æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨

```bash
docker ps
```

### å…³é—­å®¹å™¨ 

```bash
docker stop container_name_or_id
```

### æ€æ­»å®¹å™¨ (å¼ºåˆ¶å…³é—­)

```bash
docker kill container_name_or_id
```

### åˆ é™¤å®¹å™¨

```bash
docker rm container_name_or_id

# åˆ é™¤å·²ç»åœæ­¢çš„å®¹å™¨
docker container prune
# åˆ é™¤æ‰€æœ‰ï¼ŒåŒ…æ‹¬æ­£åœ¨è¿è¡Œçš„
docker rm -f $(docker ps -aq)
```

### åˆ é™¤é•œåƒ

```bash
docker rmi image_name_or_id

# åˆ é™¤æ‰€æœ‰
docker rmi -f $(docker images -q)
```