import { Tab, Tabs } from "@theme";

# VoceSpace QuickStart

This document describes how to use the provided automation script to deploy VoceSpace.

Support for one-click deployment of VoceSpace + LiveKit Server + Redis.

## File Description

- `vocespace_deploy.sh` - Linux/macOS automated deployment script
- `vocespace_deploy.bat` - Windows automated deployment script
- `README.md` - Documentation

## Features

- ✅ Automatic detection of system architecture and host IP
- ✅ Support for custom configuration files
- ✅ One-click installation and startup of all necessary components
- ✅ Intelligent handling of existing services
- ✅ Detailed status checking and log output
- ✅ Support for force reinstallation and component skipping

## Usage

### Linux/macOS

```bash
# Basic usage - use default configuration
./vocespace_deploy.sh

# Use custom configuration file
./vocespace_deploy.sh --config ./my-config.json

# Specify host IP
./vocespace_deploy.sh --host-ip 192.168.1.100

# Force reinstall all components
./vocespace_deploy.sh --force

# Skip certain component installations
./vocespace_deploy.sh --skip-redis --skip-livekit

# Combined usage
./vocespace_deploy.sh --config ./config.json --host-ip 192.168.1.100 --force
```

### Windows

```cmd
REM Basic usage - use default configuration
vocespace_deploy.bat

REM Use custom configuration file
vocespace_deploy.bat --config ./my-config.json

REM Specify host IP
vocespace_deploy.bat --host-ip 192.168.1.100

REM Force reinstall all components
vocespace_deploy.bat --force

REM Skip certain component installations
vocespace_deploy.bat --skip-redis --skip-livekit
```

## Command Line Parameters

| Parameter | Description | Example |
|-----------|-------------|---------|
| `--config FILE` | Specify configuration file path | `--config ./vocespace.conf.json` |
| `--host-ip IP` | Specify host machine IP address | `--host-ip 192.168.1.100` |
| `--force` | Force reinstall all components | `--force` |
| `--skip-redis` | Skip Redis installation | `--skip-redis` |
| `--skip-livekit` | Skip LiveKit Server installation | `--skip-livekit` |
| `-h, --help` | Show help information | `--help` |

## Configuration File Format

The script supports JSON format configuration files. Default configuration file example:

```json
{
  "livekit": {
    "key": "devkey",
    "secret": "secret",
    "url": "ws://YOUR_IP:7880"
  },
  "codec": "vp9",
  "resolution": "1080p",
  "maxBitrate": 3000000,
  "maxFramerate": 30,
  "priority": "medium",
  "redis": {
    "enabled": true,
    "host": "YOUR_IP",
    "port": 6379,
    "password": "vocespace",
    "db": 0
  },
  "server_url": "localhost"
}
```

> **Note**: The script will automatically replace `YOUR_IP` in the configuration file with the actual host IP address.

## Deployment Process

The script executes deployment in the following order:

1. **Environment Check**
   - Detect operating system and architecture
   - Check Docker installation and running status
   - Auto-detect or validate host IP

2. **Configuration Processing**
   - Verify configuration file existence and format
   - Auto-create default configuration (if not specified)
   - Update IP addresses in configuration

3. **Component Installation**
   - Install Redis (skippable)
   - Install LiveKit Server (skippable)

4. **Images and Services**
   - Pull VoceSpace Docker image for corresponding architecture
   - Start Redis service
   - Start LiveKit Server
   - Start VoceSpace container

5. **Status Check**
   - Verify all service running status
   - Display access addresses and management commands

## Service Ports

After deployment completion, the following ports will be used:

| Service | Port | Description |
|---------|------|-------------|
| VoceSpace | 3000 | Main application access port |
| LiveKit Server | 7880 | WebRTC signaling service |
| LiveKit Server | 7881 | WebRTC data transmission |
| Redis | 6379 | Cache and session storage |

## Troubleshooting

### Common Issues

1. **Docker not started**
   ```
   ❌ Docker is not running, please start Docker service
   ```
   - Linux: `sudo systemctl start docker`
   - macOS/Windows: Start Docker Desktop

2. **Port conflict**
   ```
   Error response from daemon: port is already allocated
   ```
   - Check port usage: `lsof -i :3000`
   - Stop conflicting services or use `--force` parameter

3. **Configuration file format error**
   ```
   ❌ Configuration file JSON format error
   ```
   - Use JSON validation tools to check format
   - Ensure no extra commas or quotes

4. **IP address detection failure**
   ```
   ❌ Unable to detect host IP
   ```
   - Manually specify IP: `--host-ip YOUR_IP`
   - Check network connection status

### Log Viewing

- **VoceSpace container logs**: `docker logs vocespace`
- **LiveKit Server logs**: `tail -f livekit-server.log`
- **Redis logs**: `tail -f redis.log`

### Service Management

- **Stop VoceSpace**: `docker stop vocespace`
- **Stop LiveKit**: `pkill -f livekit-server`
- **Stop Redis**: `pkill -f redis-server`

- **Restart VoceSpace**: `docker restart vocespace`
- **View container status**: `docker ps`

## System Requirements

### Minimum Requirements
- **CPU**: 2 cores
- **Memory**: 4GB RAM
- **Disk**: 10GB available space
- **Network**: Stable internet connection

### Supported Systems
- **Linux**: Ubuntu 18.04+, CentOS 7+, Debian 10+
- **macOS**: 10.14+
- **Windows**: Windows 10/11 (requires WSL2 or Docker Desktop)
## Access the application

After deployment, you can access VoceSpace at the following address:

- **VoceSpace application**: http://localhost:3000 | http://127.0.0.1:3000
